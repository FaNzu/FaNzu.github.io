# Kick the bucket — Down under CTF 2025 (Beginner)

[← Back to DUC CTF 2025](../ctf-duc-2025.md)

Category: Beginner

Points:

Author: gyrospectre

## Description

In this challenge, CI/CD pipelines and Terraform are being used to manage AWS resources. 
Part of this infrastructure utilises an S3 bucket, which is used to stage files and configuration. 
Being security conscious individuals, the admins have prevented misuse of this bucket by configuring access only to Terraform. 
They are also using S3 presigned URLs to provide timeboxed access to certain files without sharing credentials.

Given a presigned URL for flag.txt (generated by the CI/CD pipeline user), and the resource policy applied to the S3 bucket, find a way to get at the flag!

If you need a primer on some of the AWS concepts at play here:

    https://docs.aws.amazon.com/AmazonS3/latest/userguide/ShareObjectPreSignedURL.html
    https://docs.aws.amazon.com/AmazonS3/latest/userguide/example-bucket-policies.html
    https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_evaluation-logic.html#policy-eval-basics-id-rdp

Handout: [File 1](https://storage.googleapis.com/downunderctf-2025-noctf-files/noctf-files/S6xmWezitjCN3nSeQg3kK?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=GOOG1ELBSKCSEHWDHBGZCFZBP3RXLJBHVAZJTTYKCMYMRJRM6O5N35G46S26H%2F20250718%2Fauto%2Fs3%2Faws4_request&X-Amz-Date=20250718T173000Z&X-Amz-Expires=1200&X-Amz-SignedHeaders=host&X-Amz-Signature=061fc462a5536d9fd3ad2625d0dda7429e227cbc47635e10d2329513b04f2968), [File 2](https://storage.googleapis.com/downunderctf-2025-noctf-files/noctf-files/2YX9CPKz69Z3HJDh8O7ZF?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=GOOG1ELBSKCSEHWDHBGZCFZBP3RXLJBHVAZJTTYKCMYMRJRM6O5N35G46S26H%2F20250718%2Fauto%2Fs3%2Faws4_request&X-Amz-Date=20250718T173000Z&X-Amz-Expires=1200&X-Amz-SignedHeaders=host&X-Amz-Signature=e9e554feb487d1bf5c7927439eedf16a646606d69ff7446c30c04ae383324551)

## Summary and solution

To download this file, youll need to bypass the aws policy. Which states none except people with the header `aws:UserAgent="aws-sdk-go"` can get to this file.

```
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": "s3:GetObject",
      "Resource": [
        "arn:aws:s3:::kickme-95f596ff5b61453187fbc1c9faa3052e/flag.txt",
        "arn:aws:s3:::kickme-95f596ff5b61453187fbc1c9faa3052e"
      ],
      "Principal": {
        "AWS": "arn:aws:iam::487266254163:user/pipeline"
      },
      "Condition": {
        "StringLike": {
          "aws:UserAgent": "aws-sdk-go*"
        }
      }
    }
  ]
}
```

So we set the header to this and access the file

## ✅ Final Flag

    DUCTF{youtube.com/watch?v=A20QQSZsv4E}
